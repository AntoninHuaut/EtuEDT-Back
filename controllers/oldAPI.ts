import { oak } from "../dps.ts";

const CAL = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//ADE/version 6.0
CALSCALE:GREGORIAN
BEGIN:VTIMEZONE
TZID:Europe/Berlin
TZURL:http://tzurl.org/zoneinfo-outlook/Europe/Berlin
X-LIC-LOCATION:Europe/Berlin
BEGIN:DAYLIGHT
TZOFFSETFROM:+0100
TZOFFSETTO:+0200
TZNAME:CEST
DTSTART:19700329T020000
RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=-1SU
END:DAYLIGHT
BEGIN:STANDARD
TZOFFSETFROM:+0200
TZOFFSETTO:+0100
TZNAME:CET
DTSTART:19701025T030000
RRULE:FREQ=YEARLY;BYMONTH=10;BYDAY=-1SU
END:STANDARD
END:VTIMEZONE
BEGIN:VEVENT
LOCATION:edt.maner.fr
DESCRIPTION:L'url de synchronisation est à mettre à jour
DTSTAMP:20200911T180325Z
UID:20200911T180325Z-875652091@marudot.com
DTSTART;TZID=Europe/Berlin:20200901T080000
RRULE:FREQ=DAILY
DTEND;TZID=Europe/Berlin:20200901T180000
SUMMARY:URL A UPDATE
END:VEVENT
END:VCALENDAR`;

export async function handleOldAPI(context: oak.RouterContext<Record<string | number, string | undefined>, Record<string, any>>) {
  context.response.body = CAL;
  context.response.headers.set("Content-Type", "text/calendar");
}